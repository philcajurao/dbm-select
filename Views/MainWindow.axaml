<Window xmlns="https://github.com/avaloniaui"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:vm="using:dbm_select.ViewModels"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		mc:Ignorable="d"
		Width="1280"
		Height="800"
		x:Class="dbm_select.Views.MainWindow"
		x:DataType="vm:MainWindowViewModel"
		Icon="/Assets/DBM LOGO.png"
		Title="DBM Select"
		TransparencyLevelHint="AcrylicBlur"
		Background="#202020">

	<Design.DataContext>
		<vm:MainWindowViewModel/>
	</Design.DataContext>

	<Window.Resources>
		<StreamGeometry x:Key="TrashIcon">M10,2 L9,3 L5,3 L5,4 L15,4 L15,3 L11,3 L10,2 Z M5,5 L5,16 C5,17.1045695 5.8954305,18 7,18 L13,18 C14.1045695,18 15,17.1045695 15,16 L15,5 L5,5 Z</StreamGeometry>
	</Window.Resources>

	<Window.Styles>
		<Style Selector="Button.delete-overlay">
			<Setter Property="Background" Value="#99000000"/>
			<Setter Property="Opacity" Value="0"/>
			<Setter Property="HorizontalAlignment" Value="Stretch"/>
			<Setter Property="VerticalAlignment" Value="Stretch"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Padding" Value="0"/>
			<Setter Property="CornerRadius" Value="0"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Setter Property="Transitions">
				<Transitions>
					<DoubleTransition Property="Opacity" Duration="0:0:0.15"/>
				</Transitions>
			</Setter>
		</Style>
		<Style Selector="Button.delete-overlay:pointerover">
			<Setter Property="Opacity" Value="1"/>
		</Style>

		<!-- Base properties shared by all dialog buttons -->
		<Style Selector="Button.dialog-btn">
			<Setter Property="Padding" Value="15,8"/>
			<Setter Property="CornerRadius" Value="4"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Setter Property="HorizontalContentAlignment" Value="Center"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
		</Style>

		<!-- Danger Button (Red) - Keeps color on hover, lowers opacity -->
		<Style Selector="Button.danger">
			<Setter Property="Background" Value="#d9534f"/>
			<Setter Property="Foreground" Value="White"/>
		</Style>
		<Style Selector="Button.danger:pointerover /template/ ContentPresenter">
			<Setter Property="Background" Value="#d9534f"/> <!-- Force keep red -->
			<Setter Property="Opacity" Value="0.8"/> <!-- Lower opacity -->
		</Style>

		<!-- Success Button (Green) -->
		<Style Selector="Button.success">
			<Setter Property="Background" Value="#5cb85c"/>
			<Setter Property="Foreground" Value="White"/>
		</Style>
		<Style Selector="Button.success:pointerover /template/ ContentPresenter">
			<Setter Property="Background" Value="#5cb85c"/>
			<Setter Property="Opacity" Value="0.8"/>
		</Style>

		<!-- Secondary Button (Gray) -->
		<Style Selector="Button.secondary">
			<Setter Property="Background" Value="#f0f0f0"/>
			<Setter Property="Foreground" Value="Black"/>
		</Style>
		<Style Selector="Button.secondary:pointerover /template/ ContentPresenter">
			<Setter Property="Background" Value="#f0f0f0"/>
			<Setter Property="Opacity" Value="0.8"/>
		</Style>
	</Window.Styles>

	<Grid ColumnDefinitions="Auto, *" x:Name="MainGrid">

		<!-- Side Dropping Area -->
		<ExperimentalAcrylicBorder Grid.Column="0"
								   Padding="8,16">
			<ExperimentalAcrylicBorder.Material>
				<ExperimentalAcrylicMaterial
				BackgroundSource="Digger"
				TintColor="Black"
				TintOpacity="0.8"
				MaterialOpacity="0.5" />
			</ExperimentalAcrylicBorder.Material>

			<Grid RowSpacing="8"
				  RowDefinitions="Auto, *, Auto">

				<Image Grid.Row="0"
					   Source="avares://dbm-select/Assets/LOGO.png"
					   Height="100"
					   Width="200"
					   Stretch="Uniform"
					   UseLayoutRounding="True"
					   HorizontalAlignment="Center"
					   VerticalAlignment="Top"
					   Margin="0,0,0,10"/>

				<!-- Drop Targets Container -->
				<StackPanel Grid.Row="1"
							HorizontalAlignment="Center"
							VerticalAlignment="Center"
							Spacing="24">

					<!-- 8x10 Box -->
					<Border BorderBrush="Gray"
							BorderThickness="1"
							Width="120"
							Height="120"
							Tag="8x10"
							Background="Transparent">
						<Panel>
							<TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="8"
									   Text="8x10" IsVisible="{Binding Image8x10, Converter={x:Static ObjectConverters.IsNull}}"/>
							<Image Source="{Binding Image8x10.Bitmap}" Stretch="UniformToFill"
								   IsVisible="{Binding Image8x10, Converter={x:Static ObjectConverters.IsNotNull}}"/>
							<Button Classes="delete-overlay"
									Command="{Binding ClearSlotCommand}"
									CommandParameter="8x10"
									IsVisible="{Binding Image8x10, Converter={x:Static ObjectConverters.IsNotNull}}">
								<PathIcon Data="{StaticResource TrashIcon}" Foreground="White" Width="24" Height="24"/>
							</Button>
						</Panel>
					</Border>

					<!-- Barong Box -->
					<Border BorderBrush="Gray"
							BorderThickness="1"
							Width="72"
							Height="120"
							Tag="Barong"
							Background="Transparent"
							IsVisible="{Binding IsBarongVisible}">
						<Panel>
							<TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="8"
									   TextWrapping="Wrap" TextAlignment="Center" Text="Barong / Filipiniana"
									   IsVisible="{Binding ImageBarong, Converter={x:Static ObjectConverters.IsNull}}"/>
							<Image Source="{Binding ImageBarong.Bitmap}" Stretch="UniformToFill"
								   IsVisible="{Binding ImageBarong, Converter={x:Static ObjectConverters.IsNotNull}}"/>
							<Button Classes="delete-overlay"
									Command="{Binding ClearSlotCommand}"
									CommandParameter="Barong"
									IsVisible="{Binding ImageBarong, Converter={x:Static ObjectConverters.IsNotNull}}">
								<PathIcon Data="{StaticResource TrashIcon}" Foreground="White" Width="24" Height="24"/>
							</Button>
						</Panel>
					</Border>

					<!-- Creative Box -->
					<Border BorderBrush="Gray"
							BorderThickness="1"
							Width="72"
							Height="120"
							Tag="Creative"
							Background="Transparent"
							IsVisible="{Binding IsCreativeVisible}">
						<Panel>
							<TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="8"
									   Text="Creative" IsVisible="{Binding ImageCreative, Converter={x:Static ObjectConverters.IsNull}}"/>
							<Image Source="{Binding ImageCreative.Bitmap}" Stretch="UniformToFill"
								   IsVisible="{Binding ImageCreative, Converter={x:Static ObjectConverters.IsNotNull}}"/>
							<Button Classes="delete-overlay"
									Command="{Binding ClearSlotCommand}"
									CommandParameter="Creative"
									IsVisible="{Binding ImageCreative, Converter={x:Static ObjectConverters.IsNotNull}}">
								<PathIcon Data="{StaticResource TrashIcon}" Foreground="White" Width="24" Height="24"/>
							</Button>
						</Panel>
					</Border>

					<!-- Any Box -->
					<Border BorderBrush="Gray"
							BorderThickness="1"
							Width="72"
							Height="120"
							Tag="Any"
							Background="Transparent"
							IsVisible="{Binding IsAnyVisible}">
						<Panel>
							<TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="8"
									   Text="Any" IsVisible="{Binding ImageAny, Converter={x:Static ObjectConverters.IsNull}}"/>
							<Image Source="{Binding ImageAny.Bitmap}" Stretch="UniformToFill"
								   IsVisible="{Binding ImageAny, Converter={x:Static ObjectConverters.IsNotNull}}"/>
							<Button Classes="delete-overlay"
									Command="{Binding ClearSlotCommand}"
									CommandParameter="Any"
									IsVisible="{Binding ImageAny, Converter={x:Static ObjectConverters.IsNotNull}}">
								<PathIcon Data="{StaticResource TrashIcon}" Foreground="White" Width="24" Height="24"/>
							</Button>
						</Panel>
					</Border>

					<!-- INSTAX Box -->
					<Border BorderBrush="Gray"
							BorderThickness="1"
							Width="72"
							Height="120"
							Tag="Instax"
							Background="Transparent"
							IsVisible="{Binding IsInstaxVisible}">
						<Panel>
							<TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="8"
									   Text="Instax" IsVisible="{Binding ImageInstax, Converter={x:Static ObjectConverters.IsNull}}"/>
							<Image Source="{Binding ImageInstax.Bitmap}" Stretch="UniformToFill"
								   IsVisible="{Binding ImageInstax, Converter={x:Static ObjectConverters.IsNotNull}}"/>
							<Button Classes="delete-overlay"
									Command="{Binding ClearSlotCommand}"
									CommandParameter="Instax"
									IsVisible="{Binding ImageInstax, Converter={x:Static ObjectConverters.IsNotNull}}">
								<PathIcon Data="{StaticResource TrashIcon}" Foreground="White" Width="24" Height="24"/>
							</Button>
						</Panel>
					</Border>
				</StackPanel>

				<Grid Grid.Row="2"
					  ColumnDefinitions="*, *"
					  HorizontalAlignment="Center"
					  ColumnSpacing="10">
					<Button Grid.Column="0"
							Command="{Binding SubmitCommand}"
							Padding="12, 8"
							HorizontalContentAlignment="Center"
							Cursor="Hand"
							>Submit</Button>

					<Button Grid.Column="1"
							Command="{Binding ClearAllCommand}"
							Padding="12, 8"
							HorizontalContentAlignment="Center"
							Cursor="Hand"
							>Clear All</Button>
				</Grid>
			</Grid>
		</ExperimentalAcrylicBorder>

		<!-- Main Content Area -->
		<Grid RowDefinitions="Auto, *, Auto"
			  ColumnDefinitions="*, *"
			  Grid.Column="1"
			  ColumnSpacing="16"
			  RowSpacing="16"
			  Margin="16">

			<!--Top Input Data Area-->
			<ExperimentalAcrylicBorder CornerRadius="8"
									   Padding="24"
									   Grid.Row="0"
									   Grid.Column="0"
									   Grid.ColumnSpan="2">

				<ExperimentalAcrylicBorder.Material>
					<ExperimentalAcrylicMaterial
					BackgroundSource="Digger"
					TintColor="Black"
					TintOpacity="0.8"
					MaterialOpacity="0.5" />
				</ExperimentalAcrylicBorder.Material>

				<Grid ColumnDefinitions="Auto, *, Auto" VerticalAlignment="Center">
					<!-- Text Inputs -->
					<StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="20">
						<StackPanel Spacing="5">
							<TextBlock Text="Email Address" FontSize="10" Foreground="#888"/>
							<TextBox Width="200"
									 Text="{Binding ClientEmail}"
									 Watermark="e.g. client@email.com"
									 Cursor="IBeam"/>
						</StackPanel>
						<StackPanel Spacing="5">
							<TextBlock Text="Client Name" FontSize="10" Foreground="#888"/>
							<TextBox Width="200"
									 Text="{Binding ClientName}"
									 Watermark="e.g. John Doe"
									 Cursor="IBeam"/>
						</StackPanel>
					</StackPanel>

					<!-- Package Selection -->
					<StackPanel Grid.Column="2" Orientation="Vertical" VerticalAlignment="Center" Spacing="5">
						<TextBlock Text="Select Package" FontSize="10" Foreground="#888" HorizontalAlignment="Right"/>
						<StackPanel Orientation="Horizontal" Spacing="15">
							<RadioButton GroupName="Package Group"
										 Content="Basic"
										 IsChecked="{Binding IsBasicSelected}"
										 Command="{Binding UpdatePackageCommand}"
										 CommandParameter="Basic Package"
										 Cursor="Hand"/>
							<RadioButton GroupName="Package Group"
										 Content="Pkg A"
										 IsChecked="{Binding IsPkgASelected}"
										 Command="{Binding UpdatePackageCommand}"
										 CommandParameter="Package A"
										 Cursor="Hand"/>
							<RadioButton GroupName="Package Group"
										 Content="Pkg B"
										 IsChecked="{Binding IsPkgBSelected}"
										 Command="{Binding UpdatePackageCommand}"
										 CommandParameter="Package B"
										 Cursor="Hand"/>
							<RadioButton GroupName="Package Group"
										 Content="Pkg C"
										 IsChecked="{Binding IsPkgCSelected}"
										 Command="{Binding UpdatePackageCommand}"
										 CommandParameter="Package C"
										 Cursor="Hand"/>
							<RadioButton GroupName="Package Group"
										 Content="Pkg D"
										 IsChecked="{Binding IsPkgDSelected}"
										 Command="{Binding UpdatePackageCommand}"
										 CommandParameter="Package D"
										 Cursor="Hand"/>
						</StackPanel>
					</StackPanel>
				</Grid>
			</ExperimentalAcrylicBorder>

			<!--Browse Photos Area-->
			<Border BorderBrush="#666666"
					BorderThickness="1"
					CornerRadius="8"
					ClipToBounds="True"
					Grid.Row="1"
					Grid.Column="0">
				<ExperimentalAcrylicBorder CornerRadius="8"
										   Padding="24">

					<ExperimentalAcrylicBorder.Material>
						<ExperimentalAcrylicMaterial
						BackgroundSource="Digger"
						TintColor="#000000"
						TintOpacity="1"
						MaterialOpacity="1" />
					</ExperimentalAcrylicBorder.Material>

					<Grid RowDefinitions="Auto, *">
						<!-- ✅ UPDATED: Header Area with Title and Browse Button -->
						<Grid Grid.Row="0" ColumnDefinitions="*, Auto" Margin="0,0,0,10">
							<TextBlock Text="Browse Photos" 
									   FontSize="8" 
									   Foreground="#1e1e1e" 
									   VerticalAlignment="Center"/>
							
							<!-- Browse Button -->
							<Button Grid.Column="1" 
									Content="Open Folder" 
									Click="BrowseFolder_Click" 
									Classes="dialog-btn secondary" 
									Padding="8,4"
									FontSize="10"/>
						</Grid>
						<TextBlock Grid.Row="0" Text="Browse Photos" FontSize="8" Margin="0,0,0,10"/>
						<ListBox Grid.Row="1" ItemsSource="{Binding Images}" SelectedItem="{Binding SelectedImage}" Background="Transparent">
							<ListBox.ItemsPanel>
								<ItemsPanelTemplate>
									<WrapPanel Orientation="Horizontal" />
								</ItemsPanelTemplate>
							</ListBox.ItemsPanel>
							<ListBox.Styles>
								<Style Selector="ListBoxItem">
									<Setter Property="Padding" Value="4"/>
									<Setter Property="CornerRadius" Value="4"/>
								</Style>
							</ListBox.Styles>
							<ListBox.ItemTemplate>
								<DataTemplate>
									<Border Classes="image-tile" PointerPressed="OnPointerPressed" PointerMoved="OnPointerMoved" PointerReleased="OnPointerReleased" Background="Transparent">
										<StackPanel Margin="12" Width="100">
											<Image Source="{Binding Bitmap}" Width="80" Height="80" Stretch="UniformToFill" HorizontalAlignment="Center"/>
											<TextBlock Text="{Binding FileName}" TextWrapping="Wrap" HorizontalAlignment="Center" FontSize="8" Margin="0,5,0,0"/>
										</StackPanel>
									</Border>
								</DataTemplate>
							</ListBox.ItemTemplate>
						</ListBox>
					</Grid>
				</ExperimentalAcrylicBorder>
			</Border>
			<!--Quick Preview Area-->
			<ExperimentalAcrylicBorder CornerRadius="8"
									   Padding="24"
									   Grid.Row="1"
									   Grid.Column="1">

				<ExperimentalAcrylicBorder.Material>
					<ExperimentalAcrylicMaterial
					BackgroundSource="Digger"
					TintColor="Black"
					TintOpacity="0.8"
					MaterialOpacity="0.5" />
				</ExperimentalAcrylicBorder.Material>

				<Grid RowDefinitions="Auto, *, Auto">
					<TextBlock Grid.Row="0" Text="Quick Preview" FontSize="8" Foreground="#1e1e1e"/>
					<TextBlock Grid.Row="1" Text="Select a photo to preview" FontSize="12" Foreground="#d3d3d3" HorizontalAlignment="Center" VerticalAlignment="Center" IsVisible="{Binding SelectedImage, Converter={x:Static ObjectConverters.IsNull}}"/>
					<Image Grid.Row="1" Source="{Binding SelectedImage.Bitmap}" Stretch="Uniform" Margin="0,10" IsVisible="{Binding SelectedImage, Converter={x:Static ObjectConverters.IsNotNull}}"/>
					<TextBlock Grid.Row="2" Text="{Binding SelectedImage.FileName}" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" IsVisible="{Binding SelectedImage, Converter={x:Static ObjectConverters.IsNotNull}}"/>
				</Grid>
			</ExperimentalAcrylicBorder>

			<!--Sample Preview Package Area-->
			<ExperimentalAcrylicBorder CornerRadius="8"
									   Padding="24"
									   Grid.Row="2"
									   Grid.Column="0"
									   Grid.ColumnSpan="2">

				<ExperimentalAcrylicBorder.Material>
					<ExperimentalAcrylicMaterial
					BackgroundSource="Digger"
					TintColor="Black"
					TintOpacity="0.8"
					MaterialOpacity="0.5" />
				</ExperimentalAcrylicBorder.Material>

				<TextBlock Text="Sample Preview Package" FontSize="8" Foreground="#1e1e1e"/>
			</ExperimentalAcrylicBorder>
		</Grid>

		<!-- Clear Confirmation Dialog Overlay -->
		<Grid Grid.Column="0" Grid.ColumnSpan="2"
			  Background="#99000000"
			  IsVisible="{Binding IsClearConfirmationVisible}"
			  ZIndex="200">
			<ExperimentalAcrylicBorder CornerRadius="8" Padding="20" HorizontalAlignment="Center" VerticalAlignment="Center" Width="300">

				<ExperimentalAcrylicBorder.Material>
					<ExperimentalAcrylicMaterial
					BackgroundSource="Digger"
					TintColor="Black"
					TintOpacity="0.8"
					MaterialOpacity="0.5" />
				</ExperimentalAcrylicBorder.Material>

				<StackPanel Spacing="20">
					<TextBlock Text="Are you sure you want to clear all data?" FontSize="14" FontWeight="SemiBold" TextWrapping="Wrap" TextAlignment="Center" HorizontalAlignment="Center"/>
					<StackPanel Orientation="Horizontal" Spacing="20" HorizontalAlignment="Center">
						<!-- ✅ Updated to use 'danger' class -->
						<Button Content="Yes, Clear" Classes="dialog-btn danger" Command="{Binding ConfirmClearCommand}"/>
						<!-- ✅ Updated to use 'secondary' class -->
						<Button Content="Cancel" Classes="dialog-btn secondary" Command="{Binding CancelClearCommand}"/>
					</StackPanel>
				</StackPanel>
			</ExperimentalAcrylicBorder>
		</Grid>

		<!-- Submit Confirmation Dialog Overlay -->
		<Grid Grid.Column="0" Grid.ColumnSpan="2"
			  Background="#99000000"
			  IsVisible="{Binding IsSubmitConfirmationVisible}"
			  ZIndex="200">
			<ExperimentalAcrylicBorder CornerRadius="8" Padding="20" HorizontalAlignment="Center" VerticalAlignment="Center" Width="300">

				<ExperimentalAcrylicBorder.Material>
					<ExperimentalAcrylicMaterial
					BackgroundSource="Digger"
					TintColor="Black"
					TintOpacity="0.8"
					MaterialOpacity="0.5" />
				</ExperimentalAcrylicBorder.Material>

				<StackPanel Spacing="20">
					<TextBlock Text="Are you sure you want to save and submit this images?" FontSize="14" FontWeight="SemiBold" TextWrapping="Wrap" TextAlignment="Center" HorizontalAlignment="Center"/>
					<StackPanel Orientation="Horizontal" Spacing="20" HorizontalAlignment="Center">
						<!-- ✅ Updated to use 'success' class -->
						<Button Content="Yes, Submit" Classes="dialog-btn success" Command="{Binding ConfirmSubmitCommand}"/>
						<!-- ✅ Updated to use 'secondary' class -->
						<Button Content="Cancel" Classes="dialog-btn secondary" Command="{Binding CancelSubmitCommand}"/>
					</StackPanel>
				</StackPanel>
			</ExperimentalAcrylicBorder>
		</Grid>

		<!-- ✅ NEW: Validation Error Dialog Overlay -->
		<Grid Grid.Column="0" Grid.ColumnSpan="2"
			  Background="#99000000"
			  IsVisible="{Binding IsErrorDialogVisible}"
			  ZIndex="200">
			<ExperimentalAcrylicBorder CornerRadius="8" Padding="20" HorizontalAlignment="Center" VerticalAlignment="Center" Width="350">

				<ExperimentalAcrylicBorder.Material>
					<ExperimentalAcrylicMaterial
					BackgroundSource="Digger"
					TintColor="Black"
					TintOpacity="0.8"
					MaterialOpacity="0.5" />
				</ExperimentalAcrylicBorder.Material>

				<StackPanel Spacing="20">
					<TextBlock Text="Action Required" FontWeight="Bold" FontSize="16" Foreground="#d9534f" HorizontalAlignment="Center"/>

					<TextBlock Text="{Binding ErrorMessage}"
							   FontSize="14"
							   TextWrapping="Wrap"
							   TextAlignment="Center"
							   HorizontalAlignment="Center"/>

					<!-- ✅ Updated to use 'secondary' class -->
					<Button Content="OK"
							Classes="dialog-btn secondary"
							Command="{Binding CloseErrorDialogCommand}"
							HorizontalAlignment="Center"
							Padding="20,8"/>
				</StackPanel>
			</ExperimentalAcrylicBorder>
		</Grid>

		<!-- Ghost Image Overlay -->
		<Canvas x:Name="DragCanvas" Grid.Column="0" Grid.ColumnSpan="2" IsHitTestVisible="False" IsVisible="False" ZIndex="100">
			<Image x:Name="GhostImage" Width="80" Height="80" Opacity="0.7" Stretch="UniformToFill"/>
		</Canvas>

	</Grid>

</Window>